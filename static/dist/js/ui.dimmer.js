"use strict";var $=require("jquery"),UI=require("./core"),$doc=$(document),transition=UI.support.transition,Dimmer=function(){this.id=UI.utils.generateGUID("am-dimmer"),this.$element=$(Dimmer.DEFAULTS.tpl,{id:this.id}),this.inited=!1,this.scrollbarWidth=0,this.$used=$([])};Dimmer.DEFAULTS={tpl:'<div class="am-dimmer" data-am-dimmer></div>'},Dimmer.prototype.init=function(){return this.inited||($(document.body).append(this.$element),this.inited=!0,$doc.trigger("init.dimmer.amui"),this.$element.on("touchmove.dimmer.amui",function(t){t.preventDefault()})),this},Dimmer.prototype.open=function(t){this.inited||this.init();var i=this.$element;return t&&(this.$used=this.$used.add($(t))),this.checkScrollbar().setScrollbar(),i.show().trigger("open.dimmer.amui"),transition&&i.off(transition.end),setTimeout(function(){i.addClass("am-active")},0),this},Dimmer.prototype.close=function(t,i){function e(){r.hide(),this.resetScrollbar()}if(this.$used=this.$used.not($(t)),!i&&this.$used.length)return this;var r=this.$element;return r.removeClass("am-active").trigger("close.dimmer.amui"),e.call(this),this},Dimmer.prototype.checkScrollbar=function(){return this.scrollbarWidth=UI.utils.measureScrollbar(),this},Dimmer.prototype.setScrollbar=function(){var t=$(document.body),i=parseInt(t.css("padding-right")||0,10);return this.scrollbarWidth&&t.css("padding-right",i+this.scrollbarWidth),t.addClass("am-dimmer-active"),this},Dimmer.prototype.resetScrollbar=function(){return $(document.body).css("padding-right","").removeClass("am-dimmer-active"),this},module.exports=UI.dimmer=new Dimmer;