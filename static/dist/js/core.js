"use strict";var $=require("jquery");if("undefined"==typeof $)throw new Error("Amaze UI 2.x requires jQuery :-(\n爱上一匹野马，可你的家里没有草原…");var UI=$.AMUI||{},$win=$(window),doc=window.document,$html=$("html");UI.VERSION="{{VERSION}}",UI.support={},UI.support.transition=function(){var t=function(){var t=doc.body||doc.documentElement,n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var e in n)if(void 0!==t.style[e])return n[e]}();return t&&{end:t}}(),UI.support.animation=function(){var t=function(){var t=doc.body||doc.documentElement,n={WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd oanimationend",animation:"animationend"};for(var e in n)if(void 0!==t.style[e])return n[e]}();return t&&{end:t}}(),UI.support.touch="ontouchstart"in window&&navigator.userAgent.toLowerCase().match(/mobile|tablet/)||window.DocumentTouch&&document instanceof window.DocumentTouch||window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>0||window.navigator.pointerEnabled&&window.navigator.maxTouchPoints>0||!1,UI.support.mutationobserver=window.MutationObserver||window.WebKitMutationObserver||null,UI.support.formValidation="function"==typeof document.createElement("form").checkValidity,UI.utils={},UI.utils.debounce=function(t,n,e){var i;return function(){var a=this,o=arguments,r=function(){i=null,e||t.apply(a,o)},s=e&&!i;clearTimeout(i),i=setTimeout(r,n),s&&t.apply(a,o)}},UI.utils.isInView=function(t,n){var e=$(t),i=!(!e.width()&&!e.height())&&"none"!==e.css("display");if(!i)return!1;var a=$win.scrollLeft(),o=$win.scrollTop(),r=e.offset(),s=r.left,c=r.top;return n=$.extend({topOffset:0,leftOffset:0},n),c+e.height()>=o&&c-n.topOffset<=o+$win.height()&&s+e.width()>=a&&s-n.leftOffset<=a+$win.width()},UI.utils.parseOptions=UI.utils.options=function(t){if($.isPlainObject(t))return t;var n=t?t.indexOf("{"):-1,e={};if(n!=-1)try{e=new Function("","var json = "+t.substr(n)+"; return JSON.parse(JSON.stringify(json));")()}catch(i){}return e},UI.utils.generateGUID=function(t){var n=t+"-"||"am-";do n+=Math.random().toString(36).substring(2,7);while(document.getElementById(n));return n},UI.utils.getAbsoluteUrl=function(){var t;return function(n){return t||(t=document.createElement("a")),t.href=n,t.href}}(),UI.plugin=function(t,n,e){var i=$.fn[t];e=e||{},$.fn[t]=function(i){var a,o=Array.prototype.slice.call(arguments,0),r=o.slice(1),s=this.each(function(){var s=$(this),c="amui."+t,u=e.dataOptions||"data-am-"+t,l=s.data(c),d=$.extend({},UI.utils.parseOptions(s.attr(u)),"object"==typeof i&&i);(l||"destroy"!==i)&&(l||s.data(c,l=new n(this,d)),e.methodCall?e.methodCall.call(s,o,l):(e.before&&e.before.call(s,o,l),"string"==typeof i&&(a="function"==typeof l[i]?l[i].apply(l,r):l[i]),e.after&&e.after.call(s,o,l)))});return void 0===a?s:a},$.fn[t].Constructor=n,$.fn[t].noConflict=function(){return $.fn[t]=i,this},UI[t]=n},$.fn.emulateTransitionEnd=function(t){var n=!1,e=this;$(this).one(UI.support.transition.end,function(){n=!0});var i=function(){n||$(e).trigger(UI.support.transition.end),e.transitionEndTimmer=void 0};return this.transitionEndTimmer=setTimeout(i,t),this},$.fn.redraw=function(){return this.each(function(){this.offsetHeight})},$.fn.transitionEnd=function(t){function n(a){t.call(this,a),e&&i.off(e,n)}var e=UI.support.transition.end,i=this;return t&&e&&i.on(e,n),this},$.fn.removeClassRegEx=function(){return this.each(function(t){var n=$(this).attr("class");if(!n||!t)return!1;var e=[];n=n.split(" ");for(var i=0,a=n.length;i<a;i++)n[i].match(t)||e.push(n[i]);$(this).attr("class",e.join(" "))})},$.fn.alterClass=function(t,n){var e=this;if(t.indexOf("*")===-1)return e.removeClass(t),n?e.addClass(n):e;var i=new RegExp("\\s"+t.replace(/\*/g,"[A-Za-z0-9-_]+").split(" ").join("\\s|\\s")+"\\s","g");return e.each(function(t,n){for(var e=" "+n.className+" ";i.test(e);)e=e.replace(i," ");n.className=$.trim(e)}),n?e.addClass(n):e},UI.utils.rAF=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),UI.utils.cancelAF=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||function(t){window.clearTimeout(t)}}(),UI.utils.measureScrollbar=function(){if(document.body.clientWidth>=window.innerWidth)return 0;var t=$('<div style="width: 100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;"></div>');$(document.body).append(t);var n=t[0].offsetWidth-t[0].clientWidth;return t.remove(),n},UI.utils.imageLoader=function(t,n){function e(){n(t[0])}function i(){if(this.one("load",e),/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var t=this.attr("src"),n=t.match(/\?/)?"&":"?";n+="random="+(new Date).getTime(),this.attr("src",t+n)}}return t.attr("src")?void(t[0].complete||4===t[0].readyState?e():i.call(t)):void e()},UI.template=function(t,n){var e=UI.template;return e.cache[t]||(e.cache[t]=function(){var n=t,i=/^[\w\-]+$/.test(t)?e.get(t):(n="template(string)",t),a=1,o=("try { "+(e.variable?"var "+e.variable+" = this.stash;":"with (this.stash) { ")+"this.ret += '"+i.replace(/<%/g,"").replace(/%>/g,"").replace(/'(?![^\x11\x13]+?\x13)/g,"\\x27").replace(/^\s*|\s*$/g,"").replace(/\n/g,function(){return"';\nthis.line = "+ ++a+"; this.ret += '\\n"}).replace(/\x11-(.+?)\x13/g,"' + ($1) + '").replace(/\x11=(.+?)\x13/g,"' + this.escapeHTML($1) + '").replace(/\x11(.+?)\x13/g,"'; $1; this.ret += '")+"'; "+(e.variable?"":"}")+"return this.ret;} catch (e) { throw 'TemplateError: ' + e + ' (on "+n+"' + ' line ' + this.line + ')'; } //@ sourceURL="+n+"\n").replace(/this\.ret \+= '';/g,""),r=new Function(o),s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#x22;","'":"&#x27;"},c=function(t){return(""+t).replace(/[&<>\'\"]/g,function(t){return s[t]})};return function(t){return r.call(e.context={escapeHTML:c,line:1,ret:"",stash:t})}}()),n?e.cache[t](n):e.cache[t]},UI.template.cache={},UI.template.get=function(t){if(t){var n=document.getElementById(t);return n&&n.innerHTML||""}},UI.DOMWatchers=[],UI.DOMReady=!1,UI.ready=function(t){UI.DOMWatchers.push(t),UI.DOMReady&&t(document)},UI.DOMObserve=function(t,n,e){var i=UI.support.mutationobserver;i&&(n=$.isPlainObject(n)?n:{childList:!0,subtree:!0},e="function"==typeof e&&e||function(){},$(t).each(function(){var t=this,a=$(t);if(!a.data("am.observer"))try{var o=new i(UI.utils.debounce(function(n,i){e.call(t,n,i),a.trigger("changed.dom.amui")},50));o.observe(t,n),a.data("am.observer",o)}catch(r){}}))},$.fn.DOMObserve=function(t,n){return this.each(function(){UI.DOMObserve(this,t,n)})},UI.support.touch&&$html.addClass("am-touch"),$(document).on("changed.dom.amui",function(t){var n=t.target;$.each(UI.DOMWatchers,function(t,e){e(n)})}),$(function(){var t=$(document.body);UI.DOMReady=!0,$.each(UI.DOMWatchers,function(t,n){n(document)}),UI.DOMObserve("[data-am-observe]"),$html.removeClass("no-js").addClass("js"),UI.support.animation&&$html.addClass("cssanimations"),window.navigator.standalone&&$html.addClass("am-standalone"),$(".am-topbar-fixed-top").length&&t.addClass("am-with-topbar-fixed-top"),$(".am-topbar-fixed-bottom").length&&t.addClass("am-with-topbar-fixed-bottom");var n=$(".am-layout");n.find('[class*="md-block-grid"]').alterClass("md-block-grid-*"),n.find('[class*="lg-block-grid"]').alterClass("lg-block-grid"),$("[data-am-widget]").each(function(){var t=$(this);0===t.parents(".am-layout").length&&t.addClass("am-no-layout")})}),module.exports=UI;