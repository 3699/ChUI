"use strict";var $=require("jquery"),UI=require("./core"),rAF=UI.utils.rAF,cAF=UI.utils.cancelAF,smoothScrollInProgress=!1,SmoothScroll=function(o,t){function r(o){return(o/=.5)<1?.5*Math.pow(o,5):.5*(Math.pow(o-2,5)+2)}function l(){a.off("touchstart.smoothscroll.amui",p),smoothScrollInProgress=!1}function s(o){smoothScrollInProgress&&(c||(c=o),n=Math.min(1,Math.max((o-c)/S,0)),i=Math.round(m+u*r(n)),u>0&&i>h&&(i=h),u<0&&i<h&&(i=h),e!=i&&a.scrollTop(i),e=i,i!==h?(cAF(f),f=rAF(s)):(cAF(f),l()))}t=t||{};var c,n,i,a=$(o),h=parseInt(t.position)||SmoothScroll.DEFAULTS.position,m=a.scrollTop(),e=m,u=h-m,S=t.speed||Math.min(750,Math.min(1500,Math.abs(m-h))),p=function(){l()};if(!smoothScrollInProgress&&0!==u){a.on("touchstart.smoothscroll.amui",p),smoothScrollInProgress=!0;var f=rAF(s)}};SmoothScroll.DEFAULTS={position:0},$.fn.smoothScroll=function(o){return this.each(function(){new SmoothScroll(this,o)})},$(document).on("click.smoothScroll.amui.data-api","[data-am-smooth-scroll]",function(o){o.preventDefault();var t=UI.utils.parseOptions($(this).data("amSmoothScroll"));$(window).smoothScroll(t)}),module.exports=SmoothScroll;