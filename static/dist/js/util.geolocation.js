"use strict";var $=require("jquery"),UI=require("./core");UI.support.geolocation=window.navigator&&window.navigator.geolocation;var geo=UI.support.geolocation,Geolocation=function(o){this.options=o||{}};Geolocation.MESSAGES={unsupportedBrowser:"Browser does not support location services",permissionDenied:"You have rejected access to your location",positionUnavailable:"Unable to determine your location",timeout:"Service timeout has been reached"},Geolocation.ERROR_CODE={0:"unsupportedBrowser",1:"permissionDenied",2:"positionUnavailable",3:"timeout"},Geolocation.prototype.get=function(o){var e=this;o=$.extend({},this.options,o);var t=new $.Deferred;return geo?this.watchID=geo.getCurrentPosition(function(o){t.resolve.call(e,o)},function(o){t.reject(Geolocation.MESSAGES[Geolocation.ERROR_CODE[o.code]])},o):t.reject(Geolocation.MESSAGES.unsupportedBrowser),t.promise()},Geolocation.prototype.watch=function(o){if(geo&&(o=$.extend({},this.options,o),$.isFunction(o.done))){this.clearWatch();var e=$.isFunction(o.fail)?o.fail:null;return this.watchID=geo.watchPosition(o.done,e,o),this.watchID}},Geolocation.prototype.clearWatch=function(){geo&&this.watchID&&(geo.clearWatch(this.watchID),this.watchID=null)},module.exports=UI.Geolocation=Geolocation;